saveResults(data) {
                const testData = {
                    test_name: 'pelli_robson',
                    patient_name: data.patient_name,
                    duration: data.duration,
                    total_points: data.total_points,
                    correct_points: data.correct_points,
                    language: data.language,
                    contrast_sensitivity: data.contrast_sensitivity,
                    log_units: data.log_units,
                    start_time: data.start_time,
                    end_time: data.end_time,
                    responses: data.responses
                };

                console.log('Saving test data:', testData);

                // Save to main server
                fetch('http://localhost:5000/api/save_test_result', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                })
                .then(response => {
                    console.log('Response status:', response.status);

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    return response.json();
                })
                .then(result => {
                    console.log('Results saved successfully:', result);
                    if (result.success) {
                        alert('Test results saved successfully!');
                        // Redirect back to patient dashboard after a short delay
                        setTimeout(() => {
                            window.location.href = 'http://localhost:5000/patient';
                        }, 1500);
                    } else {
                        throw new Error(result.message || 'Failed to save results');
                    }
                })
                .catch(error => {
                    console.error('Error saving results:', error);
                    alert('Error saving results: ' + error.message);
                });
            }