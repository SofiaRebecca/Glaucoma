Build a Flask-based, real-time synchronized Glaucoma Detection System with:

7 ophthalmic tests

Mobile-optimized patient view

Doctor screen mirroring and test control

Excel result logging after each test

Fullscreen support

Tests can be skipped

Patient and doctor connect independently

ğŸ“‚ PROJECT STRUCTURE (Updated)
php
Copy
Edit
GLAUCOMA/
â”‚
â”œâ”€â”€ main.py                        # Central Flask controller (port 8000)
â”œâ”€â”€ excel_writer.py               # Excel writer (auto-save after every test)
â”œâ”€â”€ glaucoma_test_results.xlsx    # Excel workbook, 1 sheet per test
â”‚
â”œâ”€â”€ static/                       # CSS/JS (fullscreen, mobile styles)
â”œâ”€â”€ templates/                    # Jinja2 HTML
â”‚   â”œâ”€â”€ doctor.html               # Doctor dashboard
â”‚   â”œâ”€â”€ patient.html              # Patient listener
â”‚   â”œâ”€â”€ instructions.html         # Scrollable test intro
â”‚
â”œâ”€â”€ visual_field_test/           # Port 8001
â”‚   â””â”€â”€ app.py
â”‚
â”œâ”€â”€ motion_test/                 # Port 8004
â”‚   â””â”€â”€ app.py
â”‚
# ... repeat for other tests ...
ğŸ”„ Doctor and Patient Connect Independently
If patient connects first, they see "Waiting for doctorâ€¦" and auto-redirect when doctor sends a test

If doctor connects first, they see "Patient not connected", but can:

Queue a test â†’ will launch when patient connects

Skip the current test

WebSocket-based state sync ensures patient gets current test if doctor already queued it

Server stores state in memory or JSON file (Replit-friendly, Redis optional)

ğŸ”˜ Skip Test Option
Doctor dashboard includes a "Skip Test" button

When clicked:

Test result is marked as "Skipped" in Excel

Patient view redirects to next test or /done

Skipped tests do not block session progression

âœ… ADDITIONAL FIXES INCLUDED
ğŸ“² Mobile + Fullscreen Patient View
viewport meta tag

100vh layout

Fullscreen button before and during test

ğŸ” Visual Field Test
Counts as "seen" if click occurs within 1500ms, regardless of location

ğŸ§­ Motion Test
Moving dot â†’ patient picks direction with arrows

Direction validated + logged

ğŸ“ Excel Logging
Each test result saved immediately via excel_writer.py

Data logged:

Timestamp

Patient ID

Test name

Responses

Score/accuracy

Doctor notes

Skipped/Completed

Fullscreen used

ğŸ§ª Modular Test Apps (Ports 8001â€“8007)
Each test is its own Flask app

/start route â†’ begins test

/submit route â†’ posts result to central app

After submit, redirects to /next_test

ğŸ–¼ Doctor Dashboard
Live patient screen in iframe

Buttons:

Start any test

Skip current test

Add notes

Displays real-time test state and patient status

Optionally overlays draggable rectangle for directing patient interaction

ğŸ§‘â€ğŸ”¬ Patient View
Loads fullscreen interface

Displays test on command

Auto-redirects between tests

Displays "Waiting for doctor" if no test active

ğŸ“¦ Deployment
No login required

Fully offline

Works on Replit or local PC

Uses flask-socketio with async_mode="threading" and cors_allowed_origins="*"

ğŸ§  Summary Flow
Patient opens http://localhost:8000/patient on phone â†’ gets "Waitingâ€¦" screen

Doctor opens http://localhost:8000/doctor â†’ sees dashboard

Doctor starts a test â†’ patient view redirects

Patient takes test â†’ result saved to Excel

Doctor skips/test completes â†’ next test launched

Session proceeds until all tests done